Описание проекта: Поиск изображений с использованием моделей ML
1. Контекст проекта:
Компания: Фотохостинг "Со Смыслом" ("With Sense") для профессиональных фотографов.
Задача: Разработать демонстрационную версию поиска изображений по описанию. Суть поиска заключается в следующем: пользователь сервиса вводит описание нужной сцены. Сервис выводит несколько фотографий с такой же или похожей сценой. Для демонстрационной версии нужно выбрать лучшую модель, которая получит векторное представление изображения, векторное представление текста, а на выходе выдаст число от 0 до 1 — и покажет, насколько текст и картинка подходят друг другу. собрана информация, необходимая для обучения: имя файла изображения, идентификатор описания и текст описания. Для одной картинки может быть доступно до 5 описаний. Как видно из таблицы, в тренировочном датасете у нас 1000 изображений, имеющих 5822 связей с описаниями, 977 из которых уникальны. В тестовой выборке 100 фото, которым соответсвует 500 уникальных описаний. Получается, что каждой фотографии соответствует в точности 5 уникальных описаний.
2. Цель проекта:
Цель: Выбор лучшей модели для создания векторного представления изображения и текста, предоставление числовой оценки совпадения текста и изображения. 
3. Уникальные особенности и ограничения:
Описание: Пользователи добавляют к фотографиям подробные описания, включая место съемки, модель камеры и другие детали.
Юридические ограничения: Сервис следует законам стран, поэтому необходимо исключить изображения, запрещенные законодательством.
4. Подготовка данных:
Тренировочный датасет: 1000 изображений с 5822 связями с описаниями.
Тестовый датасет: 100 изображений с 500 уникальными описаниями.
5. Обработка данных:
Агрегация оценок: Голосование большинства для устранения несогласованных оценок экспертов.
Устранение проблемного контента: Дисклеймер для изображений, нарушающих законодательство.
6. Обучение моделей:
Лемматизация описаний: Использование WordNetLemmatizer для предобработки текста. Cоздадим функцию которая будет использовать функцию по очистке слов и лемматизировать from nltk.corpus import wordnet
Векторизация текста: Применение BERT для создания векторного представления текста. Загрузка предобученной модели/токенизатора 
Векторизация изображений: Использование ResNet18 для векторного представления изображений.
7. Объединение векторов:
Подход: Отказ от объединения векторов, вместо этого формирование вектора описания изображения и текста. По описанию (текстовому) должен формироваться вектор описания (изображения).
target - описание изображения
features - описание текста+оценки экспертов
8. Разделение датасета:
Тестирование с учетом изображений: Использование GroupShuffleSplit для разделения датасета с учетом изображений. Простое случайное разбиение не подходит: нужно исключить попадание изображения и в обучающую, и в тестовую выборки.
Для того чтобы учесть изображения при разбиении, можно воспользоваться классом GroupShuffleSplit из библиотеки sklearn.model_selection.
9. Выбор метрики и тестирование моделей:
Метрика: Выбор RMSE для оценки разницы между прогнозируемыми и фактическими значениями. Выберем метрику RMSE. Она будет активнее реагировать на большие выбросы.
RMSE: метрика, которая сообщает нам квадратный корень из средней квадратичной разницы между прогнозируемыми значениями и фактическими значениями в наборе данных. Чем ниже RMSE, тем лучше модель соответствует набору данных.
10. Результаты и выбор модели:
Модели: Сравнение линейной регрессии и нейронной сети.
Выбор модели: Нейронная сеть выбрана для дальнейшего тестирования, учитывая потенциал улучшения с углублением обучения. Построение полносвязной нейронной сети 
11. Следующие шаги:
Тестирование и углубление обучения: Проведение дополнительных тестов и обучение нейронной сети на большем числе эпох.
Оптимизация: Оценка и оптимизация работы модели для улучшения результатов.
Демонстрация продукта: Сбор предварительной версии продукта для представления руководству компании.
12. Заключение:
Результаты: Перспективы улучшения модели и ее внедрения.
Рекомендации: Тестовое внедрение на ограниченном числе изображений перед массовым запуском
